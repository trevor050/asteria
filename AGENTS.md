# AGENTS.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

## agents.md compatibility note

- This workspace is on a case-insensitive filesystem, so `AGENTS.md` and `agents.md` resolve to the same file.
- Treat this file as both `AGENTS.md` and `agents.md` for agent-memory purposes.

## Project Overview

This is a Wails desktop application with a Svelte + TypeScript frontend. The active module configuration currently tracks Wails v3 alpha packages in `go.mod`, so treat this repo as a Wails v3-alpha codebase unless explicitly migrated.

## Architecture

### Backend (Go)
- **Entry point**: `main.go` - Creates Wails app instance, configures window options, and embeds frontend assets
- **App struct**: `app.go` - Contains application logic and methods exposed to frontend
- **Module**: `asteria` (defined in `go.mod`)
- **Go version**: 1.25 (per `go.mod`)
- **Framework**: Wails v3 alpha (`github.com/wailsapp/wails/v3`)

### Frontend (Svelte + TypeScript)
- **Location**: `frontend/` directory
- **Entry point**: `frontend/src/main.ts` - Mounts Svelte app
- **Main component**: `frontend/src/App.svelte` - Root Svelte component
- **Build tool**: Vite with Svelte plugin
- **TypeScript**: Full TypeScript support with type checking

### Wails Bindings
- **Location**: `frontend/wailsjs/`
- **Generated by**: Wails build process
- **Contains**: TypeScript/JavaScript bindings for calling Go methods from frontend
- **Example**: `frontend/wailsjs/go/main/App.js` provides typed access to Go App struct methods
- **Runtime**: `frontend/wailsjs/runtime/` provides Wails runtime APIs (events, dialogs, etc.)

### Key Integration Points
- Go methods on the `App` struct are automatically exposed to frontend when bound in `main.go`
- Frontend calls Go methods via generated bindings (e.g., `import {Greet} from '../wailsjs/go/main/App.js'`)
- Context object (`a.ctx`) in App struct provides access to Wails runtime methods
- Frontend assets are embedded into the Go binary using `//go:embed all:frontend/dist`

## Development Commands

### Development Mode
```bash
wails dev
```
- Runs both Go backend and Vite dev server with hot reload
- Frontend accessible at http://localhost:34115 for browser-based debugging
- Changes to Go code or Svelte components reload automatically

### Building
```bash
wails build
```
- Creates production binary in `build/bin/` directory
- Embeds compiled frontend assets
- Output binary name: `asteria` (configured in `wails.json`)

### Frontend-Only Commands
Run these from the project root or `frontend/` directory:

```bash
# Install frontend dependencies
npm install

# Run Vite dev server (frontend only, no Go backend)
npm run dev

# Build frontend assets
npm run build

# Type check Svelte components
npm run check

# Preview production build
npm run preview
```

### Go Development
```bash
# Run Go code (without Wails runtime)
go run .

# Build Go binary (without frontend)
go build

# Install/update Go dependencies
go mod tidy

# Download Go dependencies
go mod download
```

## Configuration Files

- **wails.json**: Wails project configuration (app name, frontend commands, author info)
- **frontend/package.json**: npm dependencies and scripts
- **frontend/vite.config.ts**: Vite build configuration
- **frontend/svelte.config.js**: Svelte compiler configuration
- **frontend/tsconfig.json**: TypeScript configuration for frontend
- **go.mod**: Go module dependencies

## Project Structure Notes

- `build/bin/`: Compiled binaries (gitignored)
- `frontend/dist/`: Built frontend assets (gitignored, embedded in binary)
- `frontend/src/assets/`: Static assets (images, etc.)
- `frontend/wailsjs/`: Auto-generated Go-to-JS bindings (regenerated on build)

## Adding Go Methods Callable from Frontend

1. Add public method to `App` struct in `app.go`
2. Run `wails dev` or `wails build` - bindings regenerate automatically
3. Import generated binding in Svelte: `import {MethodName} from '../wailsjs/go/main/App.js'`
4. Call method: `MethodName(args).then(result => ...)`

## Important Patterns

- Go methods exposed to frontend must have JSON-serializable parameters and return values
- Use `a.ctx` in Go methods to access Wails runtime APIs (events, dialogs, window control)
- Frontend-to-backend communication is asynchronous (Promise-based)
- Wails dev server runs on port 34115 by default for browser debugging

## Migration Notes

- The original GitHub history used a Tauri + Svelte setup. This codebase now replaces it with Wails v3-alpha + Svelte + TypeScript.
- Keep `frontend/wailsjs/` committed because bindings are generated and consumed by the frontend.
- Keep build artifacts and local binaries out of git (`build/bin`, `frontend/dist`, root `asteria` binary).
- README was rewritten to be a proper contributor-facing quickstart + architecture guide. Keep it updated as commands/versions change.
